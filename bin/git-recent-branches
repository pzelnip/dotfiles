#!/usr/bin/env python
# -*- coding: utf-8 -*-
import argparse
import subprocess
from collections import OrderedDict

import re

parser = argparse.ArgumentParser(
    description='List/checkout recently used branches'
)
parser.add_argument('index', type=int, nargs='?', help='Move to the i-th branch in the list')
args = parser.parse_args()

d = subprocess.check_output(['git', 'reflog'])
branches = OrderedDict.fromkeys(re.findall(r'checkout: moving from (.*) to', d)).keys()

if args.index:
    subprocess.call(['git', 'checkout', branches[args.index - 1]])
else:
    for i, branch in enumerate(branches, 1):
        print('{} - {}'.format(i, branch))
